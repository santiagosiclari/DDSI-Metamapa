# --- Etapa 1: Construcci贸n (Build) ---
FROM maven:3.9.6-eclipse-temurin-21-jammy AS build
WORKDIR /app

# 1. Copiar el pom.xml y descargar dependencias (esto optimiza el cache de Docker)
COPY pom.xml .
RUN mvn dependency:go-offline -B

# 2. Copiar el c贸digo fuente y compilar
COPY src ./src
RUN mvn clean package -DskipTests

# --- Etapa 2: Ejecuci贸n (Runtime) ---
FROM eclipse-temurin:21-jre-jammy
WORKDIR /app

# Copiar el archivo JAR generado desde la etapa de construcci贸n
# Maven guarda el resultado en la carpeta 'target'
COPY --from=build /app/target/*.jar app.jar

# Exponer el puerto (se define en el docker-compose)
ENTRYPOINT ["java", "-jar", "app.jar"]